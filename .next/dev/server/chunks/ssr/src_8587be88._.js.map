{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/mouni/Desktop/marrakech/src/components/admin/AdminSidebar.tsx"],"sourcesContent":["import Link from 'next/link'\r\nimport { usePathname } from 'next/navigation'\r\nimport { LayoutDashboard, Calendar, Settings, LogOut, Package, MessageSquare } from 'lucide-react'\r\nimport { cn } from '@/lib/utils'\r\nimport { Button } from '@/components/ui/button'\r\n\r\nconst sidebarItems = [\r\n    {\r\n        title: 'Dashboard',\r\n        href: '/admin',\r\n        icon: LayoutDashboard,\r\n    },\r\n    {\r\n        title: 'Bookings',\r\n        href: '/admin/bookings',\r\n        icon: Calendar,\r\n    },\r\n    {\r\n        title: 'Services',\r\n        href: '/admin/services',\r\n        icon: Package,\r\n    },\r\n    {\r\n        title: 'Complaints',\r\n        href: '/admin/complaints',\r\n        icon: MessageSquare,\r\n    },\r\n    {\r\n        title: 'Settings',\r\n        href: '/admin/settings',\r\n        icon: Settings,\r\n    },\r\n]\r\n\r\nexport function AdminSidebar() {\r\n    const pathname = usePathname()\r\n\r\n    return (\r\n        <div className=\"flex h-full w-64 flex-col border-r bg-card px-3 py-4\">\r\n            <div className=\"mb-8 flex items-center px-3\">\r\n                <h1 className=\"text-xl font-bold\">Admin Panel</h1>\r\n            </div>\r\n            <div className=\"flex-1 space-y-1\">\r\n                {sidebarItems.map((item) => (\r\n                    <Link key={item.href} href={item.href}>\r\n                        <span\r\n                            className={cn(\r\n                                'flex items-center rounded-md px-3 py-2 text-sm font-medium hover:bg-accent hover:text-accent-foreground',\r\n                                pathname === item.href ? 'bg-accent text-accent-foreground' : 'text-muted-foreground'\r\n                            )}\r\n                        >\r\n                            <item.icon className=\"mr-2 h-4 w-4\" />\r\n                            {item.title}\r\n                        </span>\r\n                    </Link>\r\n                ))}\r\n            </div>\r\n            <div className=\"mt-auto\">\r\n                <Button\r\n                    variant=\"ghost\"\r\n                    className=\"w-full justify-start text-red-500 hover:bg-red-50 hover:text-red-600\"\r\n                    onClick={async () => {\r\n                        await fetch('/api/auth/logout', { method: 'POST' })\r\n                        window.location.href = '/admin/login'\r\n                    }}\r\n                >\r\n                    <LogOut className=\"mr-2 h-4 w-4\" />\r\n                    Logout\r\n                </Button>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;;;;;;;AAEA,MAAM,eAAe;IACjB;QACI,OAAO;QACP,MAAM;QACN,MAAM,+OAAe;IACzB;IACA;QACI,OAAO;QACP,MAAM;QACN,MAAM,sNAAQ;IAClB;IACA;QACI,OAAO;QACP,MAAM;QACN,MAAM,mNAAO;IACjB;IACA;QACI,OAAO;QACP,MAAM;QACN,MAAM,yOAAa;IACvB;IACA;QACI,OAAO;QACP,MAAM;QACN,MAAM,sNAAQ;IAClB;CACH;AAEM,SAAS;IACZ,MAAM,WAAW,IAAA,oMAAW;IAE5B,qBACI,8OAAC;QAAI,WAAU;;0BACX,8OAAC;gBAAI,WAAU;0BACX,cAAA,8OAAC;oBAAG,WAAU;8BAAoB;;;;;;;;;;;0BAEtC,8OAAC;gBAAI,WAAU;0BACV,aAAa,GAAG,CAAC,CAAC,qBACf,8OAAC,0LAAI;wBAAiB,MAAM,KAAK,IAAI;kCACjC,cAAA,8OAAC;4BACG,WAAW,IAAA,yHAAE,EACT,2GACA,aAAa,KAAK,IAAI,GAAG,qCAAqC;;8CAGlE,8OAAC,KAAK,IAAI;oCAAC,WAAU;;;;;;gCACpB,KAAK,KAAK;;;;;;;uBARR,KAAK,IAAI;;;;;;;;;;0BAa5B,8OAAC;gBAAI,WAAU;0BACX,cAAA,8OAAC,4IAAM;oBACH,SAAQ;oBACR,WAAU;oBACV,SAAS;wBACL,MAAM,MAAM,oBAAoB;4BAAE,QAAQ;wBAAO;wBACjD,OAAO,QAAQ,CAAC,IAAI,GAAG;oBAC3B;;sCAEA,8OAAC,oNAAM;4BAAC,WAAU;;;;;;wBAAiB;;;;;;;;;;;;;;;;;;AAMvD"}},
    {"offset": {"line": 146, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/mouni/Desktop/marrakech/src/lib/auth.ts"],"sourcesContent":["import { SignJWT, jwtVerify, JWTPayload } from 'jose'\r\nimport { cookies } from 'next/headers'\r\n\r\nconst secretKey = process.env.JWT_SECRET_KEY || 'your-secret-key-change-this-in-prod'\r\nconst key = new TextEncoder().encode(secretKey)\r\n\r\nexport async function encrypt(payload: JWTPayload) {\r\n    return await new SignJWT(payload)\r\n        .setProtectedHeader({ alg: 'HS256' })\r\n        .setIssuedAt()\r\n        .setExpirationTime('24h')\r\n        .sign(key)\r\n}\r\n\r\nexport async function decrypt(input: string): Promise<JWTPayload | null> {\r\n    try {\r\n        const { payload } = await jwtVerify(input, key, {\r\n            algorithms: ['HS256'],\r\n        })\r\n        return payload\r\n    } catch {\r\n        return null\r\n    }\r\n}\r\n\r\nexport async function login() {\r\n    // Verify credentials and create session\r\n    // This function will be called from the server action or API route\r\n    // For now, we'll just handle the session creation part here\r\n}\r\n\r\nexport async function getSession() {\r\n    const cookieStore = await cookies()\r\n    const session = cookieStore.get('session')?.value\r\n    if (!session) return null\r\n    return await decrypt(session)\r\n}\r\n\r\nimport { NextRequest } from 'next/server'\r\n\r\nexport async function updateSession(request: NextRequest) {\r\n    const session = request.cookies.get('session')?.value\r\n    if (!session) return\r\n\r\n    // Refresh the session so it doesn't expire\r\n    const parsed = await decrypt(session) as any\r\n    parsed.expires = new Date(Date.now() + 24 * 60 * 60 * 1000)\r\n    // const res = new Response(null) // This needs to be handled in middleware\r\n    // In middleware we just return the response with the new cookie\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;AAAA;AAAA;AACA;;;AAEA,MAAM,YAAY,QAAQ,GAAG,CAAC,cAAc,IAAI;AAChD,MAAM,MAAM,IAAI,cAAc,MAAM,CAAC;AAE9B,eAAe,QAAQ,OAAmB;IAC7C,OAAO,MAAM,IAAI,gKAAO,CAAC,SACpB,kBAAkB,CAAC;QAAE,KAAK;IAAQ,GAClC,WAAW,GACX,iBAAiB,CAAC,OAClB,IAAI,CAAC;AACd;AAEO,eAAe,QAAQ,KAAa;IACvC,IAAI;QACA,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,IAAA,oKAAS,EAAC,OAAO,KAAK;YAC5C,YAAY;gBAAC;aAAQ;QACzB;QACA,OAAO;IACX,EAAE,OAAM;QACJ,OAAO;IACX;AACJ;AAEO,eAAe;AAClB,wCAAwC;AACxC,mEAAmE;AACnE,4DAA4D;AAChE;AAEO,eAAe;IAClB,MAAM,cAAc,MAAM,IAAA,0IAAO;IACjC,MAAM,UAAU,YAAY,GAAG,CAAC,YAAY;IAC5C,IAAI,CAAC,SAAS,OAAO;IACrB,OAAO,MAAM,QAAQ;AACzB;AAIO,eAAe,cAAc,OAAoB;IACpD,MAAM,UAAU,QAAQ,OAAO,CAAC,GAAG,CAAC,YAAY;IAChD,IAAI,CAAC,SAAS;IAEd,2CAA2C;IAC3C,MAAM,SAAS,MAAM,QAAQ;IAC7B,OAAO,OAAO,GAAG,IAAI,KAAK,KAAK,GAAG,KAAK,KAAK,KAAK,KAAK;AACtD,2EAA2E;AAC3E,gEAAgE;AACpE"}},
    {"offset": {"line": 206, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/mouni/Desktop/marrakech/src/app/admin/layout.tsx"],"sourcesContent":["import { AdminSidebar } from '@/components/admin/AdminSidebar'\r\nimport { getSession } from '@/lib/auth'\r\n\r\nexport default async function AdminLayout({\r\n    children,\r\n}: {\r\n    children: React.ReactNode\r\n}) {\r\n    // We can also check session here for double security, \r\n    // but middleware handles the redirection mostly.\r\n    // However, for the layout to render the sidebar, we assume user is logged in.\r\n    // If we are on /admin/login, we shouldn't render the sidebar.\r\n    // But Next.js Layouts nest. So we need a separate layout for the authenticated part\r\n    // or check the path. \r\n    // Actually, it's better to have (auth) group or check path.\r\n    // Since I can't easily refactor folder structure to (auth) groups without moving files around too much,\r\n    // I'll just check if we are on login page in the component or use a Route Group if I was starting from scratch.\r\n    // Wait, I can't check pathname in Server Component Layout easily without headers.\r\n    // But I can check session. If no session, we render children (which might be login page) without sidebar?\r\n    // No, middleware redirects to /admin/login.\r\n    // So if I am in /admin/login, I don't want the sidebar.\r\n    // I will make a decision: /admin/login will use the root layout, or I'll handle it here.\r\n\r\n    // Actually, the best way is to put the dashboard pages in a subfolder like `src/app/admin/(dashboard)/...`\r\n    // and put the layout there.\r\n    // But I already proposed `src/app/admin/layout.tsx`.\r\n    // I'll check if I can just check the session.\r\n\r\n    const session = await getSession()\r\n\r\n    if (!session) {\r\n        // If not logged in, we are likely on /admin/login (due to middleware)\r\n        // So we just render children (the login page)\r\n        return <div className=\"min-h-screen bg-background\">{children}</div>\r\n    }\r\n\r\n    return (\r\n        <div className=\"flex h-screen overflow-hidden bg-background\">\r\n            <AdminSidebar />\r\n            <main className=\"flex-1 overflow-y-auto p-8\">\r\n                {children}\r\n            </main>\r\n        </div>\r\n    )\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;;;;AAEe,eAAe,YAAY,EACtC,QAAQ,EAGX;IACG,uDAAuD;IACvD,iDAAiD;IACjD,8EAA8E;IAC9E,8DAA8D;IAC9D,oFAAoF;IACpF,sBAAsB;IACtB,4DAA4D;IAC5D,wGAAwG;IACxG,gHAAgH;IAChH,kFAAkF;IAClF,0GAA0G;IAC1G,4CAA4C;IAC5C,wDAAwD;IACxD,yFAAyF;IAEzF,2GAA2G;IAC3G,4BAA4B;IAC5B,qDAAqD;IACrD,8CAA8C;IAE9C,MAAM,UAAU,MAAM,IAAA,gIAAU;IAEhC,IAAI,CAAC,SAAS;QACV,sEAAsE;QACtE,8CAA8C;QAC9C,qBAAO,8OAAC;YAAI,WAAU;sBAA8B;;;;;;IACxD;IAEA,qBACI,8OAAC;QAAI,WAAU;;0BACX,8OAAC,2JAAY;;;;;0BACb,8OAAC;gBAAK,WAAU;0BACX;;;;;;;;;;;;AAIjB"}}]
}